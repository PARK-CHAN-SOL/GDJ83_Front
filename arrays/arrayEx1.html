<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>arrayEx1</title>
</head>

<body>
    <!-- 전체 체크 박스 -->
    <input type="checkbox" name="ch" id="checkAll" class="ch" value="1" onclick="checkedAll()"><br>

    <!-- sub 체크 박스 -->
    <input type="checkbox" name="ch" class="ch" value="1">
    <input type="checkbox" name="ch" class="ch" value="2">
    <input type="checkbox" name="ch" class="ch" value="3">
    <input type="checkbox" name="ch" class="ch" value="4">

    <!-- 체크 박스의 checked 값 출력 함수 호출 -->
    <button onclick="checkedPrint()">CLICK</button>

    <script>
        //ch 변수에 class 명이 "ch"인 elements 유사배열 주소 대입
        const ch = document.getElementsByClassName("ch");

        //모든 sub 박스들에 이벤트 추가
        for(let i =1; i < ch.length; i++){
            ch[i].addEventListener("click", function(){
                checkedAllSub();
            })
        }
        
        //모든 체크 박스의 checked 속성 출력
        function checkedPrint() {
            for (let i = 0; i < ch.length; i++) {
                console.log((i + 1) + " 번째 체크박스 checked 속성의 값: " + ch[i].checked);
            }
            console.log("\n");
        }

        //전체 체크 클릭시 전체 체크의 값 복사
        function checkedAll() {
            for (let i = 0; i < ch.length; i++) {
                ch[i].checked = ch[0].checked;
            }
        }

        //sub 체크 박스가 모두 체크되면 자동으로 전체 체크 박스도 체크
        //sub 체크 박스가 하나라도 해제될 경우 전체 체크 박스도 해제
        function checkedAllSub() { 

            //체크 박스의 수가 3개 이상인 경우만 반복문 실행(전체 체크 기능을 수행하는 체크박스 포함)
            // -->배열의 인덱스가 -1 을 참조하지 않게 하기 위함.
            if (ch.length > 2) {

                //sub 체크 박스 상호 간의 값 비교, 하나라도 다르면 전체 체크 박스 해제 후 반복문 탈출
                for (let i = 1; i < (ch.length - 1); i++) {
                    if (ch[i].checked !== ch[i + 1].checked) {
                        ch[0].checked = false;
                        break;
                    }

                    //반복문의 최종 까지(i==ch.length-2) break문을 거치치 않았으므로(sub 체크 박스의 값이 모두 동일하므로)
                    //전체 체크 박스 체크;
                    if (i == (ch.length - 2)) {
                        ch[0].checked = ch[i].checked;
                    }
                }

                //체크 박스의 수가 2일 경우 sub 체크 박스와 전체 체크 박스는 동일한 값을 가짐.
            } else {
                ch[0].checked = ch[1].checked;
            }
        }

    </script>
</body>

</html>